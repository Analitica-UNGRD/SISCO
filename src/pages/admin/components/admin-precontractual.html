<!-- Precontractual Component -->
<section id="section-precontractual-content" class="form-section">
  <div class="form-section-header">
    <h3><span class="material-icons">assignment_ind</span> Seguimiento Precontractual</h3>
    <span class="material-icons toggle-icon">expand_more</span>
  </div>
  <div class="form-section-content">
    <form id="formPrecontractual" class="space-y-4" novalidate>
      <div class="field-group field-group-row-2">
        <div class="field-required">
          <label class="block text-sm font-medium text-gray-700">Persona</label>
          <div class="input-wrapper">
            <!-- Visible nombre legible (readonly) -->
            <input id="pre_persona_name" placeholder="Persona seleccionada" class="mt-1 p-2 border rounded w-full bg-gray-50" readonly />
            <!-- Hidden persona_id enviado al backend -->
            <input type="hidden" name="persona_id" id="pre_persona_id" />
          </div>
        </div>
        <div class="field-required">
          <label class="block text-sm font-medium text-gray-700">Etapa</label>
          <div class="input-wrapper">
            <select name="Etapa" id="pre_Etapa" class="mt-1 p-2 border rounded w-full" required>
              <option value="">Seleccione una etapa</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="field-group field-group-row-2">
        <div class="field-required">
          <label class="block text-sm font-medium text-gray-700">Fase</label>
          <div class="input-wrapper">
            <select name="Fase" id="pre_Fase" class="mt-1 p-2 border rounded w-full" required disabled>
              <option value="">Seleccione primero una etapa</option>
            </select>
          </div>
        </div>
        <div class="field-required">
          <label class="block text-sm font-medium text-gray-700">Estado</label>
          <div class="input-wrapper">
            <select name="Estado" id="pre_Estado" class="mt-1 p-2 border rounded w-full" required>
              <option value="En proceso">En proceso</option>
              <option value="Finalizado">Finalizado</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="field-group field-group-row-3">
        <div>
          <label class="block text-sm font-medium text-gray-700">Evento</label>
          <div class="input-wrapper">
            <select name="Evento" id="pre_Evento" class="mt-1 p-2 border rounded w-full">
              <option value="">Seleccione un evento</option>
              <option value="Inicio">Inicio</option>
              <option value="Finalizado">Finalizado</option>
              <option value="Cierre administrativo">Cierre Administrativo</option>
              <option value="Solicitud de Correccion">Solicitud de Correccion</option>
              <option value="Repite">Repite</option>
            </select>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Intento</label>
          <div class="input-wrapper">
            <input name="Intento" id="pre_Intento" type="number" min="1" value="1" class="mt-1 p-2 border rounded w-full" />
          </div>
        </div>
        <div class="field-required">
          <label class="block text-sm font-medium text-gray-700">Fecha</label>
          <div class="input-wrapper">
            <input name="Fecha" id="pre_Fecha" type="date" class="mt-1 p-2 border rounded w-full" required />
          </div>
        </div>
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700">Responsable</label>
        <div class="input-wrapper">
          <input name="Responsable" id="pre_Responsable" placeholder="Nombre del responsable" class="mt-1 p-2 border rounded w-full" />
        </div>
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700">Evidencia URL</label>
        <div class="input-wrapper">
          <input name="Evidencia_URL" id="pre_Evidencia_URL" placeholder="https://..." class="mt-1 p-2 border rounded w-full" />
        </div>
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700">Observaciones</label>
        <div class="input-wrapper">
          <textarea name="Observaciones" id="pre_Observaciones" placeholder="Observaciones adicionales" rows="3" class="mt-1 p-2 border rounded w-full"></textarea>
        </div>
      </div>
      
      <!-- Mostrar pre_id asignado por backend -->
      <div class="field-group">
        <div>
          <label class="block text-sm font-medium text-gray-700">ID Precontractual</label>
          <div class="input-wrapper">
            <input id="pre_pre_id" placeholder="ID precontractual" class="mt-1 p-2 border rounded w-full bg-gray-50" readonly />
            <!-- hidden original kept -->
            <input type="hidden" name="pre_id" id="pre_id" />
          </div>
        </div>
      </div>

      <div class="flex justify-end gap-2">
        <button type="button" id="btnLoadPrecontractual" class="btn btn-secondary">
          <span class="material-icons">refresh</span>
          <span>Cargar Eventos</span>
        </button>
        <button type="submit" class="btn btn-warning">
          <span class="material-icons">save</span>
          <span>Guardar Evento</span>
        </button>
      </div>
      <div id="preResult" class="mt-3 text-sm"></div>
    </form>
    
    <!-- Lista de eventos existentes -->
    <div class="mt-6">
      <h4 class="text-lg font-medium text-gray-900 mb-3">Eventos Registrados</h4>
      <div id="precontractualEventsList" class="bg-gray-50 rounded-lg p-4">
        <p class="text-gray-500 text-center">Seleccione una persona para ver sus eventos precontractuales</p>
      </div>
    </div>
  </div>
</section>
