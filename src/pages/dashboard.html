<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Admin Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="../styles/sidebar.css" rel="stylesheet"/>
<link href="../styles/loader.css" rel="stylesheet"/>
<style>
  body { font-family: 'Inter', sans-serif; background-color: #f0f2f5; }
  .bottom-area .menu-label { transition: opacity .15s ease; }
  
  /* Estilos para timeline precontractual */
  .stage-item {
    margin-bottom: 12px;
  }
  
  .stage-bar-container {
    position: relative;
    background-color: #e5e7eb;
    border-radius: 9999px;
    height: 24px;
    margin-bottom: 4px;
  }
  
  .stage-bar-fill {
    border-radius: 9999px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    color: white;
    min-width: 60px;
  }
  
  .candidate-timeline-item {
    background: white;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #e5e7eb;
    padding: 24px;
    margin-bottom: 16px;
  }
</style>
</head>
<body class="bg-gray-100">
<div class="flex h-screen">
  <div id="shared-sidebar"></div>
  <main class="flex-1 p-8 overflow-y-auto">
<header class="flex justify-between items-center mb-8">
<div>
<h2 class="text-3xl font-bold text-gray-800">Dashboard</h2>
<p class="text-gray-500">Bienvenido, Admin!</p>
</div>
<div class="flex items-center space-x-4">
<div class="relative">
<input id="global-search-input" class="bg-white rounded-full py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Search..." type="text"/>
<span class="material-icons absolute left-3 top-2.5 text-gray-400">search</span>
<!-- Dropdown para resultados -->
<div id="global-search-results" class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg z-50 hidden max-h-64 overflow-auto"></div>
</div>
<button class="bg-white rounded-full p-2 hover:bg-gray-200">
<span class="material-icons text-gray-600">notifications</span>
</button>
<img alt="User avatar" class="w-10 h-10 rounded-full object-cover" src="../assets/Dani%20SISCO-modified.png"/>
</div>
</header>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
<div id="kpi-contractors" class="bg-blue-100 p-6 rounded-2xl">
<div class="flex justify-between items-start">
<h3 class="text-lg font-medium text-blue-800 h-12">Contratistas Activos</h3>
<span class="material-icons text-blue-800">groups</span>
</div>
<p class="text-4xl font-bold text-blue-900 mt-2" id="contractors-count">--</p>
</div>
<div id="kpi-expiring" class="bg-purple-100 p-6 rounded-2xl">
<div class="flex justify-between items-start">
<h3 class="text-lg font-medium text-purple-800 h-12">Contratos a Vencer</h3>
<span class="material-icons text-purple-800">event_busy</span>
</div>
<p class="text-4xl font-bold text-purple-900 mt-2" id="expiring-count">--</p>
</div>
<div id="kpi-precontractual" class="bg-cyan-100 p-6 rounded-2xl">
<div class="flex justify-between items-start">
<h3 class="text-lg font-medium text-cyan-800 h-12">Personas en Proceso</h3>
<span class="material-icons text-cyan-800">person_add</span>
</div>
<p class="text-4xl font-bold text-cyan-900 mt-2" id="precontractual-count">--</p>
</div>
<div id="kpi-payments" class="bg-yellow-100 p-6 rounded-2xl">
<div class="flex justify-between items-start">
<h3 class="text-lg font-medium text-yellow-800 h-12">Pagos este mes</h3>
<span class="material-icons text-yellow-800">monetization_on</span>
</div>
<p class="text-4xl font-bold text-yellow-900 mt-2" id="payments-amount">--</p>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
<div class="lg:col-span-2 bg-white p-6 rounded-2xl">
<div class="flex justify-between items-center mb-4">
  <h3 class="text-xl font-semibold text-gray-800">Proceso Precontractual</h3>
  <div class="flex items-center space-x-3">
    <select id="candidato-selector" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white min-w-48">
      <option value="">Ver todos los candidatos</option>
    </select>
    <button id="btn-vista-resumida" class="px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors font-medium">
      Vista Resumida
    </button>
  </div>
</div>

<div id="vista-resumida" class="space-y-3">
  <!-- Vista resumida ser치 generada por JS -->
</div>

<div id="timeline-container" class="space-y-4 hidden">
  <div class="text-gray-500 text-center py-8">
    Cargando progreso precontractual...
  </div>
</div>

<div id="personas-tiempo-excesivo" class="mt-6">
  <h4 class="font-semibold text-gray-700 mb-2">Candidatos con mayor tiempo en proceso:</h4>
  <div id="lista-tiempo-excesivo" class="space-y-2">
    <!-- Lista de candidatos ser치 generada por JS -->
  </div>
</div>
</div>
<div class="bg-white p-6 rounded-2xl">
<h3 class="text-xl font-semibold text-gray-800 mb-4">Alertas</h3>
<div class="space-y-4" id="alertsList">
<div class="text-gray-500 text-center py-4">Cargando alertas...</div>
</div>
</div>
</div>

</main>
</div>
<!-- Protecci칩n de sesi칩n -->
<script src="/public/api-proxy.js"></script>
<script type="module" src="../lib/ui.js"></script>
<script type="module" src="../lib/session-guard.js"></script>
<script type="module" src="../lib/session-indicator.js"></script>
<script type="module">
  import { initSidebar } from '../pages-scripts/sidebar.js';
  try{ const el = document.querySelector('aside.sidebar'); if(el) initSidebar(el); }catch(e){}
</script>
<script type="module" src="../pages-scripts/dashboard.js"></script>
<script type="module">
  import { renderSidebar } from '../pages-scripts/sidebar-component.js';
  try{ renderSidebar('#shared-sidebar'); }catch(e){}
</script>
</body></html>
